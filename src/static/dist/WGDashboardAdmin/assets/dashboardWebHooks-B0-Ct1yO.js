import{L as a}from"./localeText-D6yQa3r-.js";import{B as D,r as f,L as B,D as F,c as o,d as p,a as e,b as n,m as w,e as V,y as A,C as O,v as U,F as C,i as L,n as h,u as G,A as J,t as _,g as P,z as R,f as t,q as N,j as $,x as K,_ as E,o as Y,w as I,S as M}from"./index-Bf1cwdNU.js";const Z={class:"p-3"},Q={key:0},X={for:"PayloadURL",class:"form-label fw-bold text-muted"},ee=["disabled"],se={for:"ContentType",class:"form-label fw-bold text-muted"},te=["disabled"],le={class:"form-label fw-bold text-muted"},oe={class:"form-check form-switch mb-2"},ne=["disabled"],ae={class:"form-check-label",for:"VerifySSL"},ie={key:0,class:"alert-danger alert rounded-3"},de={class:"form-label fw-bold text-muted"},ue={class:"card rounded-3"},re={class:"card-body d-flex gap-2 flex-column"},ce={class:"d-flex gap-2"},be={class:"flex-grow-1"},ve=["disabled","onUpdate:modelValue"],me={class:"flex-grow-1"},fe=["disabled","onUpdate:modelValue"],pe=["onClick"],ke={class:"form-label fw-bold text-muted"},ye={class:"form-check form-check-inline"},_e=["disabled","id","value"],he=["for"],xe={class:"form-label fw-bold text-muted"},ge={class:"form-check form-switch mb-2"},Se=["disabled"],we={class:"form-check-label",for:"IsActive"},$e={key:0,class:"alert alert-danger rounded-3"},He={class:"d-flex gap-2"},We={class:"d-flex align-items-center"},Ce={class:"mb-0"},T=D({__name:"addWebHook",props:["webHook"],emits:["refresh","delete"],async setup(d,{emit:m}){let y,r;const s=f({ContentType:String,Headers:Object,IsActive:Boolean,Notes:String,PayloadURL:String,SubscribedActions:Array,VerifySSL:Boolean,WebHookID:String}),u=d;u.webHook?s.value={...u.webHook}:([y,r]=B(()=>P("/api/webHooks/createWebHook",{},g=>{s.value=g.data})),await y,r());const k=f({peer_created:"Peer Created",peer_deleted:"Peer Deleted",peer_updated:"Peer Updated"}),x=m,i=F(),c=f(!1),S=f(""),v=f(!1),q=async g=>{g&&g.preventDefault(),v.value=!0,await R("/api/webHooks/updateWebHook",s.value,l=>{l.status?(x("refresh"),i.newMessage("Server","Webhook saved","success")):(c.value=!0,S.value=l.message,i.newMessage("Server","Webhook failed to save","danger")),v.value=!1})},z=async()=>{v.value=!0,await R("/api/webHooks/deleteWebHook",s.value,g=>{g.status?(x("delete"),i.newMessage("Server","Webhook deleted","success")):(c.value=!0,S.value=g.message,i.newMessage("Server","Webhook failed to delete","danger")),v.value=!1})};return(g,l)=>(t(),o("div",Z,[d.webHook?p("",!0):(t(),o("div",Q,[e("h6",null,[n(a,{t:"Add Webhook"})]),e("p",null,[n(a,{t:"WGDashboard will sent a POST Request to the URL below with details of any subscribed events."})])])),e("form",{onSubmit:l[7]||(l[7]=b=>q(b)),class:"d-flex flex-column gap-2"},[e("div",null,[e("label",X,[e("small",null,[n(a,{t:"Payload URL"}),l[8]||(l[8]=V("* "))])]),w(e("input",{required:"",disabled:v.value,id:"PayloadURL","onUpdate:modelValue":l[0]||(l[0]=b=>s.value.PayloadURL=b),class:"form-control rounded-3",type:"url"},null,8,ee),[[A,s.value.PayloadURL]])]),e("div",null,[e("label",se,[e("small",null,[n(a,{t:"Content Type"}),l[9]||(l[9]=V("* "))])]),w(e("select",{disabled:v.value,id:"ContentType","onUpdate:modelValue":l[1]||(l[1]=b=>s.value.ContentType=b),class:"form-select rounded-3",required:""},l[10]||(l[10]=[e("option",{value:"application/json"}," application/json ",-1),e("option",{value:"application/x-www-form-urlencoded"}," application/x-www-form-urlencoded ",-1)]),8,te),[[O,s.value.ContentType]])]),e("div",null,[e("label",le,[e("small",null,[n(a,{t:"Verify SSL"})])]),e("div",null,[e("div",oe,[w(e("input",{disabled:v.value,"onUpdate:modelValue":l[2]||(l[2]=b=>s.value.VerifySSL=b),class:"form-check-input",type:"checkbox",role:"switch",id:"VerifySSL"},null,8,ne),[[U,s.value.VerifySSL]]),e("label",ae,[n(a,{t:s.value.VerifySSL?"Enabled":"Disabled"},null,8,["t"])])]),s.value.VerifySSL?p("",!0):(t(),o("div",ie,[l[11]||(l[11]=e("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),n(a,{t:"We highly suggest to enable SSL verification"})]))])]),e("div",null,[e("label",de,[e("small",null,[n(a,{t:"Custom Headers"})])]),e("div",ue,[e("div",re,[(t(!0),o(C,null,L(s.value.Headers,(b,H)=>(t(),o("div",ce,[e("div",be,[w(e("input",{class:"form-control rounded-3 form-control-sm",disabled:v.value,"onUpdate:modelValue":W=>b.key=W,placeholder:"Key"},null,8,ve),[[A,b.key]])]),e("div",me,[w(e("input",{class:"form-control rounded-3 form-control-sm",disabled:v.value,"onUpdate:modelValue":W=>b.value=W,placeholder:"Value"},null,8,fe),[[A,b.value]])]),e("button",{class:h([{disabled:v.value},"btn btn-sm bg-danger-subtle text-danger-emphasis border-danger-subtle rounded-3"]),type:"button",onClick:W=>delete s.value.Headers[H]},l[12]||(l[12]=[e("i",{class:"bi bi-trash-fill"},null,-1)]),10,pe)]))),256)),e("button",{type:"button",class:h([{disabled:v.value},"btn btn-sm bg-primary-subtle text-primary-emphasis border-primary-subtle rounded-3"]),onClick:l[3]||(l[3]=b=>s.value.Headers[G(J)().toString()]={key:"",value:""})},[l[13]||(l[13]=e("i",{class:"bi bi-plus-lg me-2"},null,-1)),n(a,{t:"Header"})],2)])])]),l[15]||(l[15]=e("hr",null,null,-1)),e("div",null,[e("label",ke,[e("small",null,[n(a,{t:"Subscribed Actions"})])]),e("div",null,[(t(!0),o(C,null,L(k.value,(b,H)=>(t(),o("div",ye,[w(e("input",{class:"form-check-input",disabled:s.value.SubscribedActions.length===1&&s.value.SubscribedActions.includes(H)||v.value,type:"checkbox",id:H,value:H,"onUpdate:modelValue":l[4]||(l[4]=W=>s.value.SubscribedActions=W)},null,8,_e),[[U,s.value.SubscribedActions]]),e("label",{class:"form-check-label",for:H},_(b),9,he)]))),256))])]),l[16]||(l[16]=e("hr",null,null,-1)),e("div",null,[e("label",xe,[e("small",null,[n(a,{t:"Enable Webhook"})])]),e("div",null,[e("div",ge,[w(e("input",{disabled:v.value,"onUpdate:modelValue":l[5]||(l[5]=b=>s.value.IsActive=b),class:"form-check-input",type:"checkbox",role:"switch",id:"IsActive"},null,8,Se),[[U,s.value.IsActive]]),e("label",we,[n(a,{t:s.value.IsActive?"Yes":"No"},null,8,["t"])])])])]),c.value?(t(),o("div",$e,_(S.value),1)):p("",!0),e("div",He,[e("button",{type:"submit",class:h([{disabled:v.value},"ms-auto btn bg-success-subtle text-success-emphasis border-success-subtle rounded-3"])},[n(a,{t:"Save"})],2)]),d.webHook?(t(),o(C,{key:1},[l[14]||(l[14]=e("hr",null,null,-1)),e("div",We,[e("h6",Ce,[n(a,{t:"Danger Zone"})]),e("button",{onClick:l[6]||(l[6]=b=>z()),type:"button",class:h([{disabled:v.value},"btn bg-danger-subtle text-danger-emphasis border-danger-subtle rounded-3 ms-auto"])},[n(a,{t:"Delete"})],2)])],64)):p("",!0)],32)]))}}),Le={class:"d-flex flex-column gap-3"},De={class:"text-muted"},Ve={key:0},Ae={key:1},Ue={key:2},Ie={class:"d-flex gap-4 align-items-center"},Pe={class:"text-muted"},Re={key:0},Me={key:1},Te={class:"text-muted"},Be={class:"table-responsive"},Ne={class:"table"},Ee={scope:"col"},je={scope:"col"},qe={scope:"col"},ze={style:{"white-space":"nowrap"}},Fe={key:0},Oe={key:1},Ge={key:2},Je={style:{"white-space":"nowrap","overflow-x":"scroll"}},Ke={class:"bg-body-tertiary p-3 rounded-3"},Ye={class:"mb-0"},j=D({__name:"webHookSession",props:["session"],setup(d){const m=d,y=N(()=>JSON.stringify(m.session.Data,null,4));return(r,s)=>(t(),o("div",Le,[e("div",null,[e("small",De,[n(a,{t:"Status"})]),e("h3",{class:h({"text-success":d.session.Status===0,"text-danger":d.session.Status===1})},[d.session.Status===0?(t(),o("span",Ve,[s[0]||(s[0]=e("i",{class:"bi bi-check-circle-fill me-2"},null,-1)),n(a,{t:"Success"})])):d.session.Status===1?(t(),o("span",Ae,[s[1]||(s[1]=e("i",{class:"bi bi-x-circle-fill me-2"},null,-1)),n(a,{t:"Failed"})])):d.session.Status===-1?(t(),o("span",Ue,[s[2]||(s[2]=e("i",{class:"spinner-border me-2"},null,-1)),n(a,{t:"Requesting..."})])):p("",!0)],2),e("div",Ie,[e("div",null,[e("small",Pe,[n(a,{t:"Started At"})]),e("h6",null,_(d.session.StartDate),1)]),d.session.EndDate?(t(),o("div",Re,s[3]||(s[3]=[e("i",{class:"bi bi-arrow-right"},null,-1)]))):p("",!0),d.session.EndDate?(t(),o("div",Me,[e("small",Te,[n(a,{t:"Ended At"})]),e("h6",null,_(d.session.EndDate),1)])):p("",!0)])]),e("div",null,[e("h6",null,[n(a,{t:"Logs"})]),e("div",Be,[e("table",Ne,[e("thead",null,[e("tr",null,[e("th",Ee,[n(a,{t:"Datetime"})]),e("th",je,[n(a,{t:"Status"})]),e("th",qe,[n(a,{t:"Message"})])])]),e("tbody",null,[(t(!0),o(C,null,L([...d.session.Logs.Logs].reverse(),u=>(t(),o("tr",null,[e("td",ze,_(u.LogTime),1),e("td",{style:{"white-space":"nowrap"},class:h({"text-success":u.Status===0,"text-danger":u.Status===1})},[u.Status===0?(t(),o("span",Fe,s[4]||(s[4]=[e("i",{class:"bi bi-check-circle-fill me-2"},null,-1)]))):u.Status===1?(t(),o("span",Oe,s[5]||(s[5]=[e("i",{class:"bi bi-x-circle-fill me-2"},null,-1)]))):u.Status===-1?(t(),o("span",Ge,s[6]||(s[6]=[e("i",{class:"bi bi-circle me-2"},null,-1)]))):p("",!0)],2),e("td",Je,_(u.Message),1)]))),256))])])])]),e("div",null,[e("h6",null,[n(a,{t:"Data"})]),e("div",Ke,[e("pre",Ye,[e("code",null,_(y.value),1)])])])]))}}),Ze={class:"card"},Qe={class:"card-body"},Xe={key:0},es={key:1},ss={key:2},ts=D({__name:"previousWebHookSession",props:["session"],setup(d){const m=f(!0);return(y,r)=>(t(),o("div",Ze,[e("div",Qe,[e("p",{class:"d-flex mb-0",role:"button",onClick:r[0]||(r[0]=s=>m.value=!m.value)},[e("span",{class:h({"text-success":d.session.Status===0,"text-danger":d.session.Status===1})},[d.session.Status===0?(t(),o("span",Xe,r[1]||(r[1]=[e("i",{class:"bi bi-check-circle-fill me-2"},null,-1)]))):d.session.Status===1?(t(),o("span",es,r[2]||(r[2]=[e("i",{class:"bi bi-x-circle-fill me-2"},null,-1)]))):d.session.Status===-1?(t(),o("span",ss,r[3]||(r[3]=[e("i",{class:"spinner-border spinner-border-sm me-2"},null,-1)]))):p("",!0)],2),V(" "+_(d.session.StartDate)+" ",1),r[4]||(r[4]=e("i",{class:"bi bi-chevron-right ms-auto"},null,-1))]),m.value?p("",!0):(t(),$(j,{key:0,session:d.session,class:"mt-2"},null,8,["session"]))])]))}}),ls={key:0},os={class:"p-3"},ns={class:"mb-3"},as={key:0,class:"border-top p-3"},is={class:"d-flex flex-column gap-2"},ds={key:1,class:"p-3"},us=D({__name:"webHookSessions",props:["webHook"],async setup(d){let m,y;const r=d,s=f([]),u=f(void 0),k=async()=>{await P("/api/webHooks/getWebHookSessions",{WebHookID:r.webHook.WebHookID},i=>{s.value=i.data})};[m,y]=B(()=>k()),await m,y();const x=N(()=>{if(s.value)return s.value[0]});return u.value=setInterval(()=>{k()},5e3),K(()=>{clearInterval(u.value)}),(i,c)=>x.value?(t(),o("div",ls,[e("div",os,[e("h6",ns,[n(a,{t:"Latest Session"})]),(t(),$(j,{session:x.value,key:x.value.WebHookID},null,8,["session"]))]),s.value.length>1?(t(),o("div",as,[e("h6",null,[n(a,{t:"Previous Sessions"})]),e("div",is,[(t(!0),o(C,null,L(s.value.slice(1),S=>(t(),$(ts,{session:S,key:S.WebHookSessionID},null,8,["session"]))),128))])])):p("",!0)])):(t(),o("div",ds,c[0]||(c[0]=[e("div",{class:"bg-body-tertiary p-3 w-100 d-flex rounded-3"},[e("h6",{class:"mb-0 m-auto"},"No Sessions")],-1)])))}}),rs=E(us,[["__scopeId","data-v-7b6e949e"]]),cs={class:"text-body w-100 h-100 pb-2 position-relative"},bs={class:"w-100 h-100 card rounded-3"},vs={class:"border-bottom z-0"},ms={class:"d-flex text-body align-items-center sticky-top p-3 bg-body-tertiary rounded-top-3",style:{"border-top-right-radius":"0 !important"}},fs={class:"my-2"},ps={key:0,class:"row h-100 g-0"},ks={class:"col-sm-4 border-end d-flex flex-column clientListContainer"},ys={class:"d-flex flex-column overflow-y-scroll",style:{flex:"1 0 0"}},_s={class:"list-group d-flex flex-column d-flex h-100"},hs=["onClick"],xs={class:"mb-0 fw-bold text-body url"},gs={class:"url mb-0"},Ss={key:1,class:"flex-grow-1 d-flex text-muted"},ws={key:0,class:"col-sm-8 clientViewerContainer d-flex flex-column"},$s={class:"overflow-scroll",style:{flex:"1 0 0"}},Hs={class:"navbar navbar-expand-lg bg-body-tertiary sticky-top"},Ws={class:"container-fluid"},Cs={class:"navbar-nav gap-2"},Ls={class:"nav-item"},Ds={class:"nav-item"},Vs={class:"p-3"},As=D({__name:"dashboardWebHooks",setup(d){const m=f([]),y=f(!1);Y(async()=>{await r(),y.value=!0});const r=async()=>{await P("/api/webHooks/getWebHooks",{},x=>{m.value=x.data})},s=f(!1),u=f(void 0),k=f("edit");return(x,i)=>(t(),o("div",cs,[e("div",bs,[e("div",vs,[e("div",ms,[e("h6",fs,[i[7]||(i[7]=e("i",{class:"bi bi-plug-fill me-2"},null,-1)),n(a,{t:"Webhooks"})]),s.value?(t(),o("button",{key:1,class:"btn btn-sm bg-secondary-subtle text-secondary-emphasis border-1 border-secondary-subtle rounded-3 shadow-sm ms-auto",onClick:i[1]||(i[1]=c=>s.value=!1)},[i[9]||(i[9]=e("i",{class:"bi bi-chevron-left me-2"},null,-1)),n(a,{t:"Back"})])):(t(),o("button",{key:0,class:"btn btn-sm bg-primary-subtle text-primary-emphasis border-1 border-primary-subtle rounded-3 shadow-sm ms-auto",onClick:i[0]||(i[0]=c=>{s.value=!0,u.value=void 0})},[i[8]||(i[8]=e("i",{class:"bi bi-plus-circle-fill me-2"},null,-1)),n(a,{t:"Webhook"})]))])]),s.value?(t(),$(M,{key:1},{default:I(()=>[n(T,{onRefresh:i[6]||(i[6]=c=>{u.value=void 0,s.value=!1,r()})})]),_:1})):(t(),o("div",ps,[e("div",ks,[e("div",ys,[e("div",_s,[m.value.length>0?(t(!0),o(C,{key:0},L(m.value,c=>(t(),o("a",{role:"button",onClick:S=>u.value=c,class:h([{active:u.value?.WebHookID===c.WebHookID},"list-group-item list-group-item-action"]),"aria-current":"true"},[e("p",xs,_(c.PayloadURL),1),e("p",gs,[n(a,{t:"Subscribed Actions"}),V(": "+_(c.SubscribedActions.join(", ")),1)])],10,hs))),256)):(t(),o("div",Ss,[n(a,{t:"No Webhooks",class:"m-auto"})]))])])]),u.value?(t(),o("div",ws,[e("div",$s,[e("nav",Hs,[e("div",Ws,[e("div",null,[e("ul",Cs,[e("li",Ls,[e("a",{onClick:i[2]||(i[2]=c=>k.value="edit"),class:h([{active:k.value==="edit"},"nav-link rounded-3"]),role:"button"},"Edit",2)]),e("li",Ds,[e("a",{class:h([{active:k.value==="sessions"},"nav-link rounded-3"]),onClick:i[3]||(i[3]=c=>k.value="sessions"),role:"button"},"Sessions",2)])])])])]),k.value==="edit"?(t(),$(T,{key:u.value,onDelete:i[4]||(i[4]=c=>{r(),u.value=void 0}),webHook:u.value,onRefresh:i[5]||(i[5]=c=>r())},null,8,["webHook"])):k.value==="sessions"?(t(),$(M,{key:1},{fallback:I(()=>[e("div",Vs,[n(a,{t:"Loading..."})])]),default:I(()=>[(t(),$(rs,{key:u.value,webHook:u.value},null,8,["webHook"]))]),_:1})):p("",!0)])])):p("",!0)]))])]))}}),Ps=E(As,[["__scopeId","data-v-578f1a2e"]]);export{Ps as default};
